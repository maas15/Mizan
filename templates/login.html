{% extends "base.html" %}

{% block content %}
<div class="login-page">
    <!-- Animated Background -->
    <div class="login-bg">
        <div class="bg-gradient"></div>
        <div class="bg-pattern"></div>
    </div>
    
    <!-- Login Container -->
    <div class="login-container">
        <!-- Brand Header -->
        <div class="brand-header">
            <div class="brand-icon">⚖️</div>
            <h1 class="brand-name">{{ config.APP_NAME }}</h1>
            <p class="brand-tagline">{{ txt.tagline }}</p>
            <p class="brand-version">v{{ config.APP_VERSION }}</p>
        </div>
        
        <!-- Welcome Message -->
        <div class="welcome-box">
            <h2>{{ txt.welcome }}</h2>
            <p>{{ txt.welcome_sub }}</p>
        </div>
        
        <!-- Language Toggle -->
        <div class="lang-toggle">
            <a href="{{ url_for('login', lang='en') }}" class="lang-btn {{ 'active' if lang == 'en' else '' }}">
                English
            </a>
            <a href="{{ url_for('login', lang='ar') }}" class="lang-btn {{ 'active' if lang == 'ar' else '' }}">
                العربية
            </a>
        </div>
        
        <!-- Disclaimer -->
        <div class="disclaimer-box">
            <div class="disclaimer-content">
                <div class="disclaimer-icon">⚠️</div>
                <div class="disclaimer-text">
                    <p>{{ txt.disclaimer }}</p>
                    <p class="sensitive-warning"><i class="fas fa-lock"></i> {{ txt.no_sensitive }}</p>
                </div>
            </div>
        </div>
        
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
        
        <!-- Auth Tabs -->
        <div class="auth-tabs">
            <button class="auth-tab active" data-tab="login">
                <i class="fas fa-sign-in-alt"></i> {{ txt.login }}
            </button>
            <button class="auth-tab" data-tab="register">
                <i class="fas fa-user-plus"></i> {{ txt.register }}
            </button>
        </div>
        
        <!-- Login Form -->
        <div class="auth-form" id="login-form">
            <form method="POST" action="{{ url_for('login', lang=lang) }}">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> {{ txt.username }}</label>
                    <input type="text" name="username" placeholder="{{ txt.username }}" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-key"></i> {{ txt.password }}</label>
                    <input type="password" name="password" placeholder="{{ txt.password }}" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-rocket"></i> {{ txt.login }}
                </button>
            </form>
        </div>
        
        <!-- Register Form -->
        <div class="auth-form hidden" id="register-form">
            <form method="POST" action="{{ url_for('register') }}">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> {{ txt.username }}</label>
                    <input type="text" name="username" placeholder="{{ txt.username }}" minlength="3" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-key"></i> {{ txt.password }}</label>
                    <input type="password" name="password" placeholder="{{ txt.password }}" minlength="6" required>
                    <div class="password-strength" id="password-strength"></div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-magic"></i> {{ txt.register }}
                </button>
            </form>
        </div>
        
        <!-- Creator Footer -->
        <div class="creator-footer">
            <p class="created-by">{{ txt.created_by }}</p>
            <p class="creator-name">{{ config.CREATOR_NAME }}</p>
            <p class="creator-title">{{ config.CREATOR_TITLE }}</p>
            <p class="copyright">© {{ config.COPYRIGHT_YEAR }}</p>
        </div>
    </div>
</div>

<script>
// Auth tabs switching
document.querySelectorAll('.auth-tab').forEach(tab => {
    tab.addEventListener('click', () => {
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        const tabName = tab.dataset.tab;
        document.querySelectorAll('.auth-form').forEach(form => form.classList.add('hidden'));
        document.getElementById(tabName + '-form').classList.remove('hidden');
    });
});

// Password strength indicator
const passwordInput = document.querySelector('#register-form input[type="password"]');
if (passwordInput) {
    passwordInput.addEventListener('input', (e) => {
        const password = e.target.value;
        const strength = document.getElementById('password-strength');
        let score = 0;
        
        if (password.length >= 6) score++;
        if (password.length >= 8) score++;
        if (/[A-Z]/.test(password)) score++;
        if (/[0-9]/.test(password)) score++;
        if (/[^A-Za-z0-9]/.test(password)) score++;
        
        const labels = ['Very Weak', 'Weak', 'Fair', 'Strong', 'Very Strong'];
        const colors = ['#f5576c', '#f5af19', '#f5af19', '#38ef7d', '#11998e'];
        
        strength.innerHTML = `
            <div class="strength-bar" style="width: ${score * 20}%; background: ${colors[score - 1] || '#333'}"></div>
            <span class="strength-label" style="color: ${colors[score - 1] || '#666'}">${labels[score - 1] || ''}</span>
        `;
    });
}
</script>
{% endblock %}
